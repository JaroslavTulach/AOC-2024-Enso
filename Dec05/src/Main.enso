from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Snowflake import all
import Standard.Examples
import Standard.Visualization
from Standard.Base.Meta import Enso_Project

type Page
    Index index:Integer order:Dictionary

    to_text self = "Page "+self.index.to_text

type Page_Comparator
    compare p1:Page p2:Page =
      if p1.index == p2.index then Ordering.Equal else
        if p1.order != p2.order then Error.throw "Wrong orders" else
            ord = p1.order
            d1 = ord.at p1.index . catch Any (_->[])
            d2 = ord.at p2.index . catch Any (_->[])


            p1_first = d1 . contains p2.index
            p2_first = d2 . contains p1.index

            if p1_first then Ordering.Greater else
                if p2_first then Ordering.Less else
                    Nothing

    hash p:Page = p.index

Comparable.from (that:Page) = Comparable.new that Page_Comparator

## ICON group
pages_pair node2 =
    any5 = node2.split '|'
    node3 = any5.map _.parse_integer
    node3

## ICON group
topo_insert dict key value =
    node9 = dict.at key
    any8 = node9.catch Any (_->[])
    any9 = any8.insert item=value
    node10 = dict.insert key any9
    node10

## ICON group
is_properly_sorted dict node7 =
    node8 = node7.map (v-> Page.Index v dict)
    node12 = node8.at 0
    node13 = node8.at 1
    any9 = node8.sort Sort_Direction.Descending
    node14 = node8 == any9
    ## Testing orderingof pages
    any8 = Ordering.compare node12 node13
    node14

## ICON group
to_numbers node6 =
    any7 = node6.split ','
    ints7 = any7.map .parse_integer
    ints7

main =
    any1 = Enso_Project.enso_project.data/"input.txt"
    any2 = Data.read any1 ..Plain_Text
    any3 = any2.split '\n\n'
    node1 = any3.at 0
    any4 = node1.split ['\n', '\r\n', '\r']
    ## sample element to design the pipeline
    node2 = any4.at 0
    ## pipeline collapsed into pages_pair
    node3 = Main.pages_pair node2
    ## using pages pair to all elements
    node4 = any4.map pages_pair
    dictionary1 = Dictionary.empty
    ## Dictionary of pages order: Integer to [Integer]
    any5 = node4.fold dictionary1 (d-> p-> topo_insert d p.first p.second)
    node5 = any3.at 1
    any6 = node5.split ['\n', '\r\n', '\r']
    vector1 = any6.filter ..Not_Empty
    integer1 = 75
    integer2 = 43
    ## Testing insert into empty dictionary
    node10 = Main.topo_insert dictionary1 integer1 integer2
    ## Insert of the same key for the second time
    node9 = topo_insert node10 integer1  23
    ## Insert of another key
    node11 = topo_insert node9 13  42
    node14 = vector1.map to_numbers
    ## sample element to design a pipeline
    node6 = node14.at 1
    any8 = Main.is_properly_sorted any5 node6
    node7 = node14.map (p-> is_properly_sorted any5 p)
    vector2 = node14.zip node7
    vector3 = vector2.filter _.second
    node8 = vector3.map .first
    node12 = node8.map (v-> v.at (v.length/2 . floor))
    node13 = node8.at 0
    integer3 = node13.length
    quot1 = integer3/2
    any7 = node12.compute ..Sum




#### METADATA ####
[[{"index":{"value":1067},"size":{"value":11}},"6784e7bf-53dc-4ab4-a011-ddc1536475ea"],[{"index":{"value":1067},"size":{"value":15}},"09f2d45c-4a3b-4904-a906-54e2b509078f"],[{"index":{"value":1095},"size":{"value":24}},"e8dba74a-ead8-45f6-b1cc-3fe9fb3a6974"],[{"index":{"value":1124},"size":{"value":5}},"5035508d-13ff-4663-9296-f08131e1ed5b"],[{"index":{"value":1186},"size":{"value":11}},"cd9912af-8030-4e47-95af-9fd5d2861efe"],[{"index":{"value":1209},"size":{"value":11}},"0e187eb1-8578-45c0-a49c-f06ff99a470d"],[{"index":{"value":1209},"size":{"value":23}},"f7ac20c3-e68c-4cf7-b1ca-aef751f10101"],[{"index":{"value":1244},"size":{"value":11}},"aa7e10e7-64cf-4bf6-bfa7-d0393bceeb3c"],[{"index":{"value":1244},"size":{"value":22}},"363773b1-5bd9-4bdd-a349-affa1e7ae6e7"],[{"index":{"value":1280},"size":{"value":20}},"46eb793c-b7f9-4608-9d65-5f790005307d"],[{"index":{"value":1305},"size":{"value":6}},"2c4847fe-1ac0-4437-9186-4b68d552236a"],[{"index":{"value":1346},"size":{"value":4}},"4df7ecd1-5d14-4c33-afa6-5cf31d268ae9"],[{"index":{"value":1351},"size":{"value":5}},"b3b3e9cf-937d-4582-8e17-f84a33e39d0e"],[{"index":{"value":1371},"size":{"value":33}},"e79ca542-8a94-4dec-9ad8-6751957f16fa"],[{"index":{"value":1418},"size":{"value":10}},"7ef52213-bda9-4b32-8102-531f5a16b3fe"],[{"index":{"value":1442},"size":{"value":10}},"e5fc8cd9-1f27-429c-a68c-960bc9aac777"],[{"index":{"value":1464},"size":{"value":10}},"02bde6ef-5e0e-4da5-915c-08d1ce9d1619"],[{"index":{"value":1464},"size":{"value":36}},"84098d5f-2df2-4d61-a774-ca85f3f60c5b"],[{"index":{"value":1514},"size":{"value":13}},"1e17cf71-d435-4614-8a32-348d7c934e6a"],[{"index":{"value":1571},"size":{"value":16}},"e6851b57-e6f2-408c-bb2f-c63df0ebada5"],[{"index":{"value":1571},"size":{"value":23}},"c9e74993-2fdb-45b8-8795-0b3627e4de42"],[{"index":{"value":1571},"size":{"value":30}},"7644d972-2a8c-47d7-892f-266dfff4c52e"],[{"index":{"value":1606},"size":{"value":6}},"e43bba6f-3044-4088-b2eb-07b7c17389dd"],[{"index":{"value":1639},"size":{"value":5}},"ce259d71-fb85-4478-97dc-7621e4bdc587"],[{"index":{"value":1658},"size":{"value":15}},"beed9b3e-02bf-483f-b67d-5e848b9f873e"],[{"index":{"value":1686},"size":{"value":23}},"d1c131f2-5707-49e0-bdac-24473f5a5c5e"],[{"index":{"value":1714},"size":{"value":5}},"eb3e61b2-a7e7-4406-b3b1-09927fafd983"],[{"index":{"value":1739},"size":{"value":25}},"b5130a9c-26a0-4d0d-95e8-3e81657ee3f0"],[{"index":{"value":1739},"size":{"value":42}},"a03a62d4-6d96-4730-b789-f94eff4ae040"],[{"index":{"value":1793},"size":{"value":9}},"66b18ed8-4b43-43e6-8768-c231c3eb8440"],[{"index":{"value":1793},"size":{"value":14}},"a2e86ddd-1c0d-4628-940c-62bf3d04ad4c"],[{"index":{"value":1793},"size":{"value":27}},"3b67c7fc-77d3-4955-974f-34952c384595"],[{"index":{"value":1832},"size":{"value":10}},"100ea468-51e7-4664-af83-7c83af95e3eb"],[{"index":{"value":1832},"size":{"value":17}},"3de92afc-3fbe-478e-9a37-2dc22359e0db"],[{"index":{"value":1862},"size":{"value":9}},"97456a4e-cfe2-4f34-ab1a-e8c895966ad5"],[{"index":{"value":1883},"size":{"value":11}},"9491d3a7-57e8-4b50-8145-01ed6adecb6a"],[{"index":{"value":1883},"size":{"value":32}},"db1d8ae8-75e2-4d3c-9733-ff458b57f813"],[{"index":{"value":1973},"size":{"value":9}},"37869f49-5248-4a30-a011-8d667b16869d"],[{"index":{"value":2037},"size":{"value":21}},"5ef39de0-cd86-4d4a-a940-e30aee7f9555"],[{"index":{"value":2111},"size":{"value":19}},"c06b9a5d-93c6-47db-bffb-f1cb6475ce91"],[{"index":{"value":2149},"size":{"value":16}},"3fca75b7-3b87-412b-ab7d-2b3aee59493f"],[{"index":{"value":2232},"size":{"value":10}},"3be7a2e9-b417-46b5-8a90-279b7e1e1776"],[{"index":{"value":2232},"size":{"value":22}},"86a644eb-e514-419d-8cd0-a709b1f71de4"],[{"index":{"value":2232},"size":{"value":63}},"45032cb5-420f-4aaa-8014-6fca51bc39f7"],[{"index":{"value":2308},"size":{"value":9}},"67ecbaef-ffa9-4284-8186-3885516c8765"],[{"index":{"value":2329},"size":{"value":11}},"c03b9c1d-f608-4a55-8648-45742d0d9e5d"],[{"index":{"value":2329},"size":{"value":32}},"5d823e4a-7e23-41ba-ab40-d21a44dc3092"],[{"index":{"value":2376},"size":{"value":11}},"640dc51b-2505-4e68-ac91-f6c85f949fab"],[{"index":{"value":2376},"size":{"value":23}},"ddae2a0f-b50c-47a6-92c2-e5ab1faee4bf"],[{"index":{"value":2415},"size":{"value":2}},"ab7da189-5482-4f61-9914-3ce73761fc0f"],[{"index":{"value":2433},"size":{"value":2}},"879fef8e-c811-43c2-b053-916fb76a1e93"],[{"index":{"value":2493},"size":{"value":46}},"b80a0432-1aa7-4325-b283-ee25bdd13b45"],[{"index":{"value":2602},"size":{"value":11}},"5fd85ab0-ac10-4a07-bf18-7320517d841b"],[{"index":{"value":2602},"size":{"value":27}},"827b09bc-a114-4d0b-ad6c-1605174e77a2"],[{"index":{"value":2602},"size":{"value":31}},"74e1fc2e-5882-4698-abed-41c489e89956"],[{"index":{"value":2676},"size":{"value":24}},"4a5fe09b-93cd-4b0b-889f-820ef6871f87"],[{"index":{"value":2714},"size":{"value":22}},"12d9bd26-d607-4d51-8820-7797968a5912"],[{"index":{"value":2792},"size":{"value":11}},"0daee4e4-398e-49a6-8755-d200308b6f9f"],[{"index":{"value":2815},"size":{"value":34}},"6df0da2a-0e4f-4f48-9f02-ea64900b0266"],[{"index":{"value":2862},"size":{"value":42}},"517a79f3-7f56-449c-a480-58e0d5c1d8c1"],[{"index":{"value":2919},"size":{"value":10}},"626d36f8-cb78-4e37-a32a-5465e866eb93"],[{"index":{"value":2919},"size":{"value":16}},"71e8725f-45ef-4ec5-a90a-0028a774e1cc"],[{"index":{"value":2950},"size":{"value":23}},"92e15b3e-c1d6-4ca4-99f1-e03faaf594e6"],[{"index":{"value":2986},"size":{"value":18}},"116963b3-7d0c-4c7f-a3b5-234f52ef3b9c"],[{"index":{"value":3018},"size":{"value":41}},"e9e5fdc3-477f-44e3-947c-2593ca60fee3"],[{"index":{"value":3073},"size":{"value":10}},"f2160e64-6333-496c-9c02-2c5ec616d95d"],[{"index":{"value":3099},"size":{"value":13}},"10fa2d9f-04d3-4bcb-ba75-f2b1d6728378"],[{"index":{"value":3125},"size":{"value":10}},"d8cc3363-7f9b-4e01-8fcf-2f1a65ca79de"],[{"index":{"value":3147},"size":{"value":14}},"ee7fdcbe-f24b-465f-a689-00124af4da6c"],[{"index":{"value":3147},"size":{"value":20}},"7ac118d5-f8ff-4450-bc35-ab8a8cb1bbba"]]
{"ide":{"node":{"09f2d45c-4a3b-4904-a906-54e2b509078f":{"position":{"vector":[-642,-202]}},"6784e7bf-53dc-4ab4-a011-ddc1536475ea":{"position":{"vector":[-642,-202]}},"e8dba74a-ead8-45f6-b1cc-3fe9fb3a6974":{"position":{"vector":[-662,-274]}},"5035508d-13ff-4663-9296-f08131e1ed5b":{"position":{"vector":[-662,-346]}},"cd9912af-8030-4e47-95af-9fd5d2861efe":{"position":{"vector":[-85,-479]}},"f7ac20c3-e68c-4cf7-b1ca-aef751f10101":{"position":{"vector":[-48,-560]}},"0e187eb1-8578-45c0-a49c-f06ff99a470d":{"position":{"vector":[-48,-560]}},"363773b1-5bd9-4bdd-a349-affa1e7ae6e7":{"position":{"vector":[75,-613]}},"aa7e10e7-64cf-4bf6-bfa7-d0393bceeb3c":{"position":{"vector":[75,-613]}},"46eb793c-b7f9-4608-9d65-5f790005307d":{"position":{"vector":[-116,-722]}},"2c4847fe-1ac0-4437-9186-4b68d552236a":{"position":{"vector":[-116,-794]}},"4df7ecd1-5d14-4c33-afa6-5cf31d268ae9":{"position":{"vector":[395,-121]}},"b3b3e9cf-937d-4582-8e17-f84a33e39d0e":{"position":{"vector":[382,-9]}},"e79ca542-8a94-4dec-9ad8-6751957f16fa":{"position":{"vector":[395,-193]},"visualization":{"show":false,"width":670.359375,"height":260,"project":{"project":"Builtin"},"name":"Table"}},"7ef52213-bda9-4b32-8102-531f5a16b3fe":{"position":{"vector":[704,-310]}},"e5fc8cd9-1f27-429c-a68c-960bc9aac777":{"position":{"vector":[876,-310]}},"84098d5f-2df2-4d61-a774-ca85f3f60c5b":{"position":{"vector":[625,-632]},"visualization":{"show":false,"width":603.1875,"height":253}},"02bde6ef-5e0e-4da5-915c-08d1ce9d1619":{"position":{"vector":[570,-567]},"visualization":{"show":true,"width":603.1875,"height":253}},"1e17cf71-d435-4614-8a32-348d7c934e6a":{"position":{"vector":[549,-696]},"visualization":{"show":true}},"7644d972-2a8c-47d7-892f-266dfff4c52e":{"position":{"vector":[746,-410]},"visualization":{"show":true}},"c9e74993-2fdb-45b8-8795-0b3627e4de42":{"position":{"vector":[651,-667]}},"e6851b57-e6f2-408c-bb2f-c63df0ebada5":{"position":{"vector":[651,-667]}},"e43bba6f-3044-4088-b2eb-07b7c17389dd":{"position":{"vector":[643,-918]}},"ce259d71-fb85-4478-97dc-7621e4bdc587":{"position":{"vector":[-33,86]}},"beed9b3e-02bf-483f-b67d-5e848b9f873e":{"position":{"vector":[-33,14]}},"d1c131f2-5707-49e0-bdac-24473f5a5c5e":{"position":{"vector":[-16,-56]}},"eb3e61b2-a7e7-4406-b3b1-09927fafd983":{"position":{"vector":[-16,-128]}},"a03a62d4-6d96-4730-b789-f94eff4ae040":{"position":{"vector":[-551,417]}},"b5130a9c-26a0-4d0d-95e8-3e81657ee3f0":{"position":{"vector":[-551,417]}},"3b67c7fc-77d3-4955-974f-34952c384595":{"position":{"vector":[-611,289]}},"a2e86ddd-1c0d-4628-940c-62bf3d04ad4c":{"position":{"vector":[-611,289]}},"66b18ed8-4b43-43e6-8768-c231c3eb8440":{"position":{"vector":[-611,289]}},"3de92afc-3fbe-478e-9a37-2dc22359e0db":{"position":{"vector":[-481,192]},"visualization":{"show":false,"height":385}},"100ea468-51e7-4664-af83-7c83af95e3eb":{"position":{"vector":[-481,192]}},"97456a4e-cfe2-4f34-ab1a-e8c895966ad5":{"position":{"vector":[-481,17]}},"db1d8ae8-75e2-4d3c-9733-ff458b57f813":{"position":{"vector":[-432,-58]}},"9491d3a7-57e8-4b50-8145-01ed6adecb6a":{"position":{"vector":[-432,-58]}},"37869f49-5248-4a30-a011-8d667b16869d":{"position":{"vector":[-690,-130]}},"5ef39de0-cd86-4d4a-a940-e30aee7f9555":{"position":{"vector":[-662,-238]}},"c06b9a5d-93c6-47db-bffb-f1cb6475ce91":{"position":{"vector":[-372,-166]},"visualization":{"show":false,"width":319.78125,"height":560}},"3fca75b7-3b87-412b-ab7d-2b3aee59493f":{"position":{"vector":[-291,-266]}},"45032cb5-420f-4aaa-8014-6fca51bc39f7":{"position":{"vector":[-481,-382]},"visualization":{"show":false,"project":{"project":"Builtin"},"name":"Table"}},"86a644eb-e514-419d-8cd0-a709b1f71de4":{"position":{"vector":[-342,-338]},"visualization":{"show":true,"project":{"project":"Builtin"},"name":"Table"}},"3be7a2e9-b417-46b5-8a90-279b7e1e1776":{"position":{"vector":[-333,-313]}},"67ecbaef-ffa9-4284-8186-3885516c8765":{"position":{"vector":[395,311]}},"5d823e4a-7e23-41ba-ab40-d21a44dc3092":{"position":{"vector":[414,239]},"visualization":{"show":false,"height":249}},"c03b9c1d-f608-4a55-8648-45742d0d9e5d":{"position":{"vector":[443,181]}},"ddae2a0f-b50c-47a6-92c2-e5ab1faee4bf":{"position":{"vector":[467,167]},"visualization":{"show":false,"width":338,"height":239}},"640dc51b-2505-4e68-ac91-f6c85f949fab":{"position":{"vector":[490,129]}},"ab7da189-5482-4f61-9914-3ce73761fc0f":{"position":{"vector":[-629,-525]}},"879fef8e-c811-43c2-b053-916fb76a1e93":{"position":{"vector":[-848,-560]}},"b80a0432-1aa7-4325-b283-ee25bdd13b45":{"position":{"vector":[-1118,-593]}},"74e1fc2e-5882-4698-abed-41c489e89956":{"position":{"vector":[-939,-665]}},"827b09bc-a114-4d0b-ad6c-1605174e77a2":{"position":{"vector":[6,-696]}},"5fd85ab0-ac10-4a07-bf18-7320517d841b":{"position":{"vector":[6,-696]}},"4a5fe09b-93cd-4b0b-889f-820ef6871f87":{"position":{"vector":[-939,-768]}},"12d9bd26-d607-4d51-8820-7797968a5912":{"position":{"vector":[598,71]},"visualization":{"show":false,"width":567.078125,"height":254}},"0daee4e4-398e-49a6-8755-d200308b6f9f":{"position":{"vector":[346,-55]}},"6df0da2a-0e4f-4f48-9f02-ea64900b0266":{"position":{"vector":[218,-266]},"visualization":{"show":true}},"517a79f3-7f56-449c-a480-58e0d5c1d8c1":{"position":{"vector":[642,-220]},"visualization":{"show":false,"height":277}},"71e8725f-45ef-4ec5-a90a-0028a774e1cc":{"position":{"vector":[598,-328]},"visualization":{"show":false,"width":458.484375,"height":283}},"626d36f8-cb78-4e37-a32a-5465e866eb93":{"position":{"vector":[598,-328]}},"92e15b3e-c1d6-4ca4-99f1-e03faaf594e6":{"position":{"vector":[659,-450]}},"116963b3-7d0c-4c7f-a3b5-234f52ef3b9c":{"position":{"vector":[706,-529]},"visualization":{"show":true,"width":542,"height":166}},"e9e5fdc3-477f-44e3-947c-2593ca60fee3":{"position":{"vector":[756,-768]},"visualization":{"show":true}},"f2160e64-6333-496c-9c02-2c5ec616d95d":{"position":{"vector":[414,-751]}},"10fa2d9f-04d3-4bcb-ba75-f2b1d6728378":{"position":{"vector":[458,-830]}},"d8cc3363-7f9b-4e01-8fcf-2f1a65ca79de":{"position":{"vector":[414,-902]}},"7ac118d5-f8ff-4450-bc35-ab8a8cb1bbba":{"position":{"vector":[756,-990]},"visualization":{"show":true}},"ee7fdcbe-f24b-465f-a689-00124af4da6c":{"position":{"vector":[756,-990]}}},"widget":{},"snapshot":"eJyFVt9P4zgQfs9fMdc+FHSL2aSFAlKRuAWtkG5ZJNDtA6DIJJPWR2J7bbfQ1f3xJzt2frSF7UObeGa+Gc98M9NCiQruDOU5VTn5i2oEVkmhDNCyjIqe9J4+lx+IL6mhzx8CXPy4e1/4VYh5iemFZO/r3HHxWpT0pefDPzZKV2+0kiXqLcE/TC9pyX5RwwTfQLY3J9/Q0IB8xbVIb5X4FzMTRWYtEW7pHCMAgGue4xsw+312zQ3OUYFQOaqzS5ZZcKrWkdM0IjX4ZkBjWcAMBhYCBn/aV+LsidfouEi/iEpSRY1QDiNzrwgyPnPmMql/Z04KwAqQcY0GsxnIxD+bBXL4bsNifE6ufi5pCVhq9GbB0AUOfzjD+tkZXiklFDELJV5h8EMJPq+vqAd9EPsRKodZg9UT5THMrJxQ00ZJIKMmW8AFX8NeenD+8LTfN0o6RskHRlHPTMZpwZQ2MLNuCWSCG8q4bjD62kmrnfS0fZh9cJcsb9HP7FeF1KDaTkswS3aa/Y1a77axnxthFozP6xgWVC9A+qqDDOF5njyXSByZ98yCGqe1DzPoSDm+gpVt0SsaDuH6y/cbmCuxlJGkc9SppEwBFzkmnmKUr49gVh8RLUtmYPTfyIns2RhmToVUVEJKJFUaU1a3Rau06csIKVLGNSoDOcsMvOAaVrRcBmJbq1NbHJYZS4QXXIdoTnw0p2Q3jyhfn9ZBnRDvghmsZg6+AY8/B3SvYyOwph2NzaiZTqUSElW5TrVQBvM6eKs97QQeIpy6pOytDs5d7kk9OVbOaL/1k3j1E3vRz+35uHsed+9Wn2o334Qy6SVT6EYPuUSdIc8teRqcSbCwA6K54nAI96gNC63N+FwU4EjQzXTD2DCIfMh1hB0n2yVO+bJ6RqWdwnFLp6mP5zjQ6VNNJ8aNntaVqzO3g01OJ4oqyngLaKdMd2ITtC/Sv+TU0MMB43JpiHkzg2Bl0263FlFI8xqGkNuSMp7e25ns1TzBG+4/8kfe0j+upeO2dJSvQ8Jjb/MweuSjTzB6VOF39BRqoN26AiyxQm7ACMhRszm38wIkk1gy3rI2qd1NWnfDYaMFmShLKjXmNk0C2obudes3yjjZbPaAtdSWEE4KTmqEXbMhPt0gTUIktlAbnvJmD9r0tFuRYCXNOrhqzyEQz+9RCGvVCHjwz0+bw2hCClHmPV97+cE5yINz6I0XkKSewJJozATP29Y76lSvabBj7+Dod9VbYWaE8gw4JgUr7SIg5EaY9Kq5qWevVZsedU9sLSfjzV4ME8sW0KWrc8P+8HJ13BykIRWN1+As+LmudUXhCKZphW7yFULVBy5DYFjVks5OnK4fH0HjApLxNjrlwixQNYPbGcU7kE4hHgNMkv688rl17GonyW+bhm63TChnPOlV+SRkcMdQdyxztg3KtEVxM92y7D1Lud+hR9Ia/mKyxuqIx81dk0Cg1NO0t068dj0WHZ137Y9m3azsXfdWpEQ+N4tD+w+nKIVQ+521M95eO76kQRKPPYAT/lwKYwsYlA6TzYEeJ25LLA0CIXfLKor+B/Gg1kU="}}